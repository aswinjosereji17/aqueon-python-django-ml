{% extends 'index.html' %}


{% block content_mainn %}

    <!-- Shop Start -->
    <div class="container-fluid">
        <div class="row px-xl-5">
            <!-- Shop Sidebar Start -->
            <div class="col-lg-3 col-md-4">
                <!-- Price Start -->
                <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Filter by price</span></h5>
                <!-- <div class="bg-light p-4 mb-30">
                    <form>                 
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="price-1">
                            <label class="custom-control-label" for="price-1">$0 - $100</label>
                            <span class="badge border font-weight-normal">150</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="price-2">
                            <label class="custom-control-label" for="price-2">$100 - $200</label>
                            <span class="badge border font-weight-normal">295</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="price-3">
                            <label class="custom-control-label" for="price-3">$200 - $300</label>
                            <span class="badge border font-weight-normal">246</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="price-4">
                            <label class="custom-control-label" for="price-4">$300 - $400</label>
                            <span class="badge border font-weight-normal">145</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
                            <input type="checkbox" class="custom-control-input" id="price-5">
                            <label class="custom-control-label" for="price-5">$400 - $500</label>
                            <span class="badge border font-weight-normal">168</span>
                        </div> 
                    </form>
                </div> -->
                <!-- Price End -->

                <!-- Price Range -->
<input type="checkbox" id="price_0_100" value="0-100"> $0 - $100
<input type="checkbox" id="price_101_200" value="101-200"> $101 - $200
<input type="checkbox" id="price_201_500" value="201-500"> $201 - $500

<!-- Rating -->
<input type="checkbox" id="rating_5" value="5"> 5
<input type="checkbox" id="rating_4" value="4"> 4
<input type="checkbox" id="rating_3" value="3"> 3
<input type="checkbox" id="rating_2" value="2"> 2
<input type="checkbox" id="rating_1" value="1"> 1

                
                <!-- Color Start -->
               <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Filter by reviews</span></h5>
                <!-- <div class="bg-light p-4 mb-30">
                    <form>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="color-1">
                            <label class="custom-control-label" for="color-1">5 star</label>
                            <span class="badge border font-weight-normal">5</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="color-2">
                            <label class="custom-control-label" for="color-2">4 star</label>
                            <span class="badge border font-weight-normal">4</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="color-3">
                            <label class="custom-control-label" for="color-3">3 star</label>
                            <span class="badge border font-weight-normal">3</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="color-4">
                            <label class="custom-control-label" for="color-4">2 star</label>
                            <span class="badge border font-weight-normal">2</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
                            <input type="checkbox" class="custom-control-input" id="color-5">
                            <label class="custom-control-label" for="color-5">1 star</label>
                            <span class="badge border font-weight-normal">1</span>
                        </div>
                    </form>
                </div>  -->
                <!-- Color End -->

                <!-- Size Start -->
                <h5 class="section-title position-relative text-uppercase mb-3"><span class="bg-secondary pr-3">Filter by size</span></h5>
                <div class="bg-light p-4 mb-30">
                    <form>
                        {% comment %} <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" checked id="size-all">
                            <label class="custom-control-label" for="size-all">All Size</label>
                            <span class="badge border font-weight-normal">1000</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="size-1">
                            <label class="custom-control-label" for="size-1">XS</label>
                            <span class="badge border font-weight-normal">150</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="size-2">
                            <label class="custom-control-label" for="size-2">S</label>
                            <span class="badge border font-weight-normal">295</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="size-3">
                            <label class="custom-control-label" for="size-3">M</label>
                            <span class="badge border font-weight-normal">246</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
                            <input type="checkbox" class="custom-control-input" id="size-4">
                            <label class="custom-control-label" for="size-4">L</label>
                            <span class="badge border font-weight-normal">145</span>
                        </div>
                        <div class="custom-control custom-checkbox d-flex align-items-center justify-content-between">
                            <input type="checkbox" class="custom-control-input" id="size-5">
                            <label class="custom-control-label" for="size-5">XL</label>
                            <span class="badge border font-weight-normal">168</span>
                        </div> {% endcomment %}
                    </form>
                </div>
                <!-- Size End -->
            </div>
            <!-- Shop Sidebar End -->


            <!-- Shop Product Start -->
            <div id="hello" class="col-lg-9 col-md-8">
                <div class="row pb-3">
                    <div class="col-12 pb-1">
                        <div class="d-flex align-items-center justify-content-between mb-4">
                            <div>
                                <button class="btn btn-sm btn-light"><i class="fa fa-th-large"></i></button>
                                <button class="btn btn-sm btn-light ml-2"><i class="fa fa-bars"></i></button>
                            </div>
                            <div class="ml-2">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">Sorting</button>
                                    <div class="dropdown-menu dropdown-menu-right">
                                        <a class="dropdown-item" href="#">Latest</a>
                                        <a class="dropdown-item" href="#">Popularity</a>
                                        <a class="dropdown-item" href="#">Best Rating</a>
                                    </div>
                                </div>
                                <div class="btn-group ml-2">
                                    <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">Showing</button>
                                    <div class="dropdown-menu dropdown-menu-right">
                                        <a class="dropdown-item" href="#">10</a>
                                        <a class="dropdown-item" href="#">20</a>
                                        <a class="dropdown-item" href="#">30</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="filtered-products" class="col-lg-9 col-md-8">
                       
                    </div>


<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    $(document).ready(function () {
        $('input[type="checkbox"]').change(function () {
            updateFilteredProducts();
        });

        function updateFilteredProducts() {
    var priceFilters = $('input[name="price"]:checked').map(function () {
        return this.value;
    }).get();

    var ratingFilters = $('input[name="rating"]:checked').map(function () {
        return this.value;
    }).get();

    $.ajax({
        url: '/filter-products/',
        data: {price: JSON.stringify(priceFilters), rating: ratingFilters},
        method: 'GET',
        dataType: 'json',
        success: function (data) {
            $('#hello').hide();
            displayFilteredProducts(data.filtered_products);
        }
    });
}


        function displayFilteredProducts(products) {
            var $filteredProductsDiv = $('#filtered-products');
            $filteredProductsDiv.empty();

            $.each(products, function (index, product) {
                var productHtml = '<div><h3>' + product.prod_name + '</h3><p>Price: $' + product.price + '</p></div>';
                $filteredProductsDiv.append(productHtml);
            });
        }
    });
</script>

                    
                    {% for product in products %}
                    <div style="cursor: pointer;" class="col-lg-4 col-md-6 col-sm-6 pb-1" onclick="navigateToSubcategoryProducts({{ product.prod_id }})">
                        <div class="product-item bg-light mb-4">
                            <div class="product-img position-relative overflow-hidden">
                                <img  style="width:400px; height:250px;" src="{{  product.productdescription.img1.url }}" alt="{{ product.prod_name }}">
                                <div class="product-action">
                                     {% comment %} <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-shopping-cart"></i></a> {% endcomment %}
                                    <a class="btn btn-outline-dark btn-square" href="{% url 'add_to_wishlist' product.prod_id %}"><i class="far fa-heart"></i></a>
                                    {% comment %} <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-sync-alt"></i></a>
                                    <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-search"></i></a>  {% endcomment %}
                                </div>
                            </div>
                            <div class="text-center py-4">
                                <a class="h6 text-decoration-none text-truncate" href="">{{ product.prod_name }}</a>
                                <div class="d-flex align-items-center justify-content-center mt-2">
                                    <h5>Rs.{{ product.price }}</h5><h6 class="text-muted ml-2"><del>Rs.{{ product.price }}</del></h6>
                                </div>
                                <div class="d-flex align-items-center justify-content-center mb-1">
                                    <div class="d-flex align-items-center justify-content-center mb-1">
                                        {% if product.avg_rating == 5 %}
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                        {% elif product.avg_rating == 4 %}
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                        {% elif product.avg_rating == 3 %}
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-success mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                        {% elif product.avg_rating == 2 %}
                                            <small class="fa fa-star text-danger mr-1"></small>
                                            <small class="fa fa-star text-danger mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                        {% elif product.avg_rating <= 1 %}
                                            <small class="fa fa-star text-danger mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                            <small class="fa fa-star text-secondary mr-1"></small>
                                        {% endif %}
                                        <small></small>
                                    </div>
                
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                    <script>
                        function navigateToSubcategoryProducts(prodId) {
                            window.location.href = `/prod_desc/${prodId}/`;
                        }
                    </script>
                    
                </div>
            </div>
            <!-- Shop Product End -->
        </div>
    </div>
    <!-- Shop End -->

{% endblock %}